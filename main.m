% Copyright Â© 2024 Martin Schonger
% This software is licensed under the GPLv3.


%% sim1:
close all; yalmip('clear'); clear variables; clear globals;
run_abccds(output_root_path='./output/', ...
    data=abcds.data.unity_rec('./datasets/unity_rec_gp/config.txt'), i_idxs={1:3, 4:6}, seed=22, ...
    deg_f=[2,2], deg_V=[2,2], deg_B=[2,2], deg_B_slack=[2,2], ...
    PBM_MAX_ITER=100, UM_MAX_ITER=100, PEN_UP=0.0, PRECISION_2=1e-9, epsilon=0.0001, ...
    delta_lower=[1;1]*(1e-1), delta_upper=[1;1]*(1e6), xi_V=[1;1]*(1e-1), rho_w_V=[1;1]*(0), ...
    alpha=[1;1]*(1e-1), xi_B=[1;1]*(1e-1), sigma=[1;1]*(1), phi=[1;1]*(1.001), rho_w_B=[1;1]*(0), ...
    X_i={abcds.set.multiset(abcds.set.hypersphere([0.63038;0.25586;-0.18285], 5)), ...
        abcds.set.multiset(abcds.set.hypersphere([1.1456;5.1646;4.3844], 5))}, ...
    W_i={abcds.set.multiset(abcds.set.hypersphere([0.63038;0.25586;-0.18285;1.1456;5.1646;4.3844], 5)), ...
        abcds.set.multiset(abcds.set.hypersphere([1.1456;5.1646;4.3844;0.63038;0.25586;-0.18285], 5))}, ...
    X_0={abcds.set.multiset(abcds.set.hypersphere([0.55799;0.16735;0.0069685], 0.040195)), ...
        abcds.set.multiset(abcds.set.hypersphere([1.3215;4.955;4.6993], 0.040195))}, ...
    X_u={abcds.set.multiset(abcds.set.hypersphere_squashed([0.3877;0.2162;-0.0955], 0.045, [1;0.4;0.1])), ...
        abcds.set.multiset(abcds.set.set(@(x) sum((x(2, :) - (5.05)).^2, 1)-(pi/2)*(pi/2), 3))})

%% sim2:
close all; yalmip('clear'); clear variables; clear globals;
run_abccds(output_root_path='./output/', ...
    data=abcds.data.unity_rec('./datasets/unity_rec_gp/config2.txt'), i_idxs={1:3, 4:6}, seed=22, ...
    deg_f=[2,2], deg_V=[2,2], deg_B=[2,2], deg_B_slack=[2,2], ...
    PBM_MAX_ITER=100, UM_MAX_ITER=100, PEN_UP=0.0, PRECISION_2=1e-9, epsilon=0.0001, ...
    delta_lower=[1;1]*(1e-1), delta_upper=[1;1]*(1e6), xi_V=[1;1]*(1e-1), rho_w_V=[1;1]*(0), ...
    alpha=[1;1]*(1e-1), xi_B=[1;1]*(1e-1), sigma=[1;1]*(1), phi=[1;1]*(1.001), rho_w_B=[1;1]*(0), ...
    X_i={abcds.set.multiset(abcds.set.hypersphere([0.55355;0.24001;0.13169], 5)), ...
        abcds.set.multiset(abcds.set.hypersphere([1.2311;4.3585;4.754], 5))}, ...
    W_i={abcds.set.multiset(abcds.set.hypersphere([0.55355;0.24001;0.13169;1.2311;4.3585;4.754], 5)), ...
        abcds.set.multiset(abcds.set.hypersphere([1.2311;4.3585;4.754;0.55355;0.24001;0.13169], 5))}, ...
    X_0={abcds.set.multiset(abcds.set.hypersphere([0.60552;0.26827;-0.13002], 0.031454)), ...
        abcds.set.multiset(abcds.set.hypersphere([1.5529;3.9515;3.9748], 0.063753))}, ...
    X_u={abcds.set.multiset(abcds.set.hypersphere_squashed([0.4846;0.3881;0.0154], 0.045, [0.4;1;0.1])), ...
        abcds.set.multiset(abcds.set.set(@(x) sum((x(1, :) - 1.4).^2, 1)-(pi/1.4)*(pi/1.4), 3))})

%% exp1:
close all; yalmip('clear'); clear variables; clear globals;
run_abccds(output_root_path='./output/', ...
    data=abcds.data.robot_rec('./datasets/robot_recordings/gbin/reference_trajectories.txt', dims_to_keep=1:6, type='6d', preprocess_args=struct('cut_begin', 100, 'cut_end', 0, 'movemean', true)), i_idxs={1:3, 4:6}, seed=22, ...
    deg_f=[2,3], deg_V=[2,2], deg_B=[2,2], deg_B_slack=[2,2], ...
    PBM_MAX_ITER=20, UM_MAX_ITER=100, PEN_UP=0.0, PRECISION_2=1e-9, epsilon=0.0001, ...
    delta_lower=[1;1]*(1e-1), delta_upper=[1;1]*(1e6), xi_V=[1;1]*(1e-1), rho_w_V=[1;1]*(0), ...
    alpha=[1;1]*(1e-1), xi_B=[1;1]*(1e-1), sigma=[1;1]*(1), phi=[1;1]*(1.001), rho_w_B=[1;1]*(0), ...
    X_i={abcds.set.multiset(abcds.set.hypersphere([0.40454;-0.16644;0.33725], 5)), ...
        abcds.set.multiset(abcds.set.hypersphere([1.1867;-4.1552;-1.172], 5))}, ...
    W_i={abcds.set.multiset(abcds.set.hypersphere([0.40454;-0.16644;0.33725;1.1867;-4.1552;-1.172], 5)), ...
        abcds.set.multiset(abcds.set.hypersphere([1.1867;-4.1552;-1.172;0.40454;-0.16644;0.33725], 5))}, ...
    X_0={abcds.set.multiset(abcds.set.hypersphere([0.56765;0.35162;0.061836], 0.04)), ...
        abcds.set.multiset(abcds.set.hypersphere([0.7905;-3.125;-0.0067913], 0.04))}, ...
    X_u={abcds.set.multiset(abcds.set.set(@(x) -sum((x(1, :) - 0.15).^2, 1)+(0.13)*(0.13), 3), ...
        abcds.set.set(@(x) -sum((x(2, :) - 0.045).^2, 1)+(0.275)*(0.275), 3), ...
        abcds.set.set(@(x) -sum((x(3, :) - 0.135).^2, 1)+(0.235)*(0.235), 3)), ...
        abcds.set.multiset(abcds.set.set(@(x) sum((x(3, :)).^2, 1)-(0.7*pi)*(0.7*pi), 3))})


%% video:
%% exp2:
close all; yalmip('clear'); clear variables; clear globals;
run_abccds(output_root_path='./output/', ...
    data=abcds.data.robot_rec('./datasets/robot_recordings/gbin/reference_trajectories.txt', dims_to_keep=1:6, type='6d', preprocess_args=struct('cut_begin', 100, 'cut_end', 0, 'movemean', true)), i_idxs={1:3, 4:6}, seed=22, ...
    deg_f=[2,3], deg_V=[2,2], deg_B=[2,2], deg_B_slack=[2,2], ...
    PBM_MAX_ITER=[50, 20], UM_MAX_ITER=[250, 100], PEN_UP=0.0, PRECISION_2=1e-9, epsilon=0.0001, ...
    delta_lower=[1;1]*(1e-1), delta_upper=[1;1]*(1e6), xi_V=[1;1]*(1e-1), rho_w_V=[1;1]*(0), ...
    alpha=[1;1]*(1e-1), xi_B=[1;1]*(1e-1), sigma=[1;1]*(1), phi=[1;1]*(1.001), rho_w_B=[1;1]*(0), ...
    X_i={abcds.set.multiset(abcds.set.hypersphere([0.40454;-0.16644;0.33725], 5)), ...
        abcds.set.multiset(abcds.set.hypersphere([1.1867;-4.1552;-1.172], 5))}, ...
    W_i={abcds.set.multiset(abcds.set.hypersphere([0.40454;-0.16644;0.33725;1.1867;-4.1552;-1.172], 5)), ...
        abcds.set.multiset(abcds.set.hypersphere([1.1867;-4.1552;-1.172;0.40454;-0.16644;0.33725], 5))}, ...
    X_0={abcds.set.multiset(abcds.set.hypersphere_squashed([0.56765;0.35162;0.281836], 0.23, [1;1;1])), ...
        abcds.set.multiset(abcds.set.hypersphere([0.7905;-3.125;-0.0067913], 0.04))}, ...
    X_u={abcds.set.multiset(abcds.set.set(@(x) -sum((x(1, :) - 0.92).^2, 1)+(0.1)*(0.1), 3), ...
        abcds.set.set(@(x) -sum((x(2, :)).^2, 1)+(0.4)*(0.4), 3), ...
        abcds.set.set(@(x) -sum((x(3, :) - 0.3).^2, 1)+(0.3)*(0.3), 3)), ...
        abcds.set.multiset(abcds.set.set(@(x) sum((x(3, :)).^2, 1)-(0.7*pi)*(0.7*pi), 3))})
